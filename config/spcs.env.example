# Copy to config/spcs.env and edit. This file is sourced by ./cli/spcs.sh (bash).

# ---- Snowflake CLI connection selection ----
# Name from your Snowflake CLI config.toml [connections.<name>]
SNOW_CONNECTION=spcs-dev

# Optional: use repo-local Snowflake CLI config at ./.snowflake/config.toml (recommended)
# If you keep config there, you usually don't need to set SNOWFLAKE_HOME.

# ---- Naming / locations (Snowflake objects) ----
APP_DB=APP_DB
APP_SCHEMA=APP_SCHEMA

# Stages
CONFIG_STAGE=@${APP_DB}.${APP_SCHEMA}.app_config_superset
ARTIFACT_STAGE=@${APP_DB}.${APP_SCHEMA}.app_artifacts

# Secrets
SECRET_SUPERSET_DB_URI=${APP_DB}.${APP_SCHEMA}.superset_db_uri
SECRET_SUPERSET_SECRET_KEY=${APP_DB}.${APP_SCHEMA}.superset_secret_key
SECRET_SUPERSET_FERNET_KEY=${APP_DB}.${APP_SCHEMA}.superset_fernet_key
SECRET_SUPERSET_ADMINS=${APP_DB}.${APP_SCHEMA}.superset_admins

# Image repository (Snowflake Image Repository) - all images referenced by SPCS specs should live here.
IMAGE_REPO_NAME=superset_repo
IMAGE_REPO=${APP_DB}.${APP_SCHEMA}.${IMAGE_REPO_NAME}

# Image name/tag (within the image repository)
IMAGE_NAME=superset-spcs
IMAGE_TAG=latest

# Fully-qualified image reference used inside SPCS specs.
# Example (shape): /APP_DB/APP_SCHEMA/superset_repo/superset-spcs:latest
SPCS_IMAGE=/${APP_DB}/${APP_SCHEMA}/${IMAGE_REPO_NAME}/${IMAGE_NAME}:${IMAGE_TAG}
SPCS_REDIS_IMAGE=/${APP_DB}/${APP_SCHEMA}/${IMAGE_REPO_NAME}/redis:7-alpine
SPCS_POSTGRES_IMAGE=/${APP_DB}/${APP_SCHEMA}/${IMAGE_REPO_NAME}/postgres:16-alpine

# ---- SPCS deployment targets ----
COMPUTE_POOL=YOUR_COMPUTE_POOL
SERVICE_NAME=superset

# Network/EAI (when Superset needs egress to managed Postgres host)
PG_EAI_NAME=pg_meta_eai

# ---- Optional toggles ----
# Set to 1 to run bootstrap job before service apply
RUN_BOOTSTRAP=1
BOOTSTRAP_JOB_NAME=superset_bootstrap

# Choose which service spec to apply by default: managed or allinone
SPCS_PROFILE=managed

# Set to 1 to create DB/SCHEMA/stages/image repository if missing.
AUTO_BOOTSTRAP_SNOWFLAKE=1

# Set to 1 to login to the Snowflake image registry and push images for this repo.
PUSH_IMAGE=0
